import{a as O}from"./chunk-EO5AUDNA.js";import{a as U,b as c,c as V,d as I,e as j,f as q,g as B,j as z,k as A}from"./chunk-2RDBIOTE.js";import{i as R,j as M,m as k}from"./chunk-HXDFN2JZ.js";import{f as T,l as D,p as G,s as L}from"./chunk-G5L6SHPN.js";import{k as S,r as N}from"./chunk-MX6TGMN2.js";import{Ab as u,Jb as P,Lb as g,Ra as a,Rb as w,Tb as s,Ub as f,_ as p,fa as _,fc as y,ga as C,gb as E,na as b,r as x,sb as m,tb as d,xb as F,yb as n,zb as o}from"./chunk-LUCBGVJY.js";function Y(i,t){if(i&1&&(n(0,"div",6),_(),n(1,"svg",21),u(2,"path",22),o(),C(),n(3,"span"),s(4),o()()),i&2){let r=g();a(4),f(r.errorMessage())}}function J(i,t){if(i&1&&(n(0,"span",12),s(1),o()),i&2){let r=g();a(),f(r.formUtils.getFieldError(r.registerForm,"email"))}}function K(i,t){if(i&1&&(n(0,"span",12),s(1),o()),i&2){let r=g();a(),f(r.formUtils.getFieldError(r.registerForm,"password"))}}function Q(i,t){if(i&1&&(n(0,"span",12),s(1),o()),i&2){let r=g();a(),f(r.formUtils.getFieldError(r.registerForm,"confirmPassword"))}}function W(i,t){i&1&&(u(0,"span",23),s(1," Creando cuenta... "))}function X(i,t){i&1&&s(0," Crear Cuenta ")}var H=class i{error=b(null);fb=p(z);authService=p(L);router=p(R);registerForm;firestore=p(T);registerTrigger=b(null);registerResource=N({params:()=>this.registerTrigger(),stream:({params:t})=>t?this.authService.register(t.email,t.password):x(null)});formUtils=O;constructor(){this.registerForm=this.fb.group({email:["",[c.required,c.email]],password:["",[c.required,c.minLength(6)]],confirmPassword:["",[c.required]]},{validators:this.passwordMatchValidator}),y(()=>{this.registerResource.hasValue()&&this.registerResource.value()&&(console.log("Registro exitoso, navegando a /simpsons"),this.router.navigate(["/simpsons"]))})}passwordMatchValidator(t){let r=t.get("password"),e=t.get("confirmPassword");return r&&e&&r.value!==e.value?(e.setErrors({passwordMismatch:!0}),{passwordMismatch:!0}):null}onSubmit(){let{email:t,password:r}=this.registerForm.value;this.authService.register(t,r).subscribe({next:async e=>{let l={uid:e.user.uid,email:e.user.email,role:"user",displayName:e.user.displayName||""};await G(D(this.firestore,"users",e.user.uid),l),this.router.navigate(["/home"])},error:e=>{this.error.set(this.getErrorMessage(e.code))}})}getErrorMessage(t){return{"auth/email-already-in-use":"Este correo ya est\xE1 registrado","auth/invalid-email":"El correo electr\xF3nico no es v\xE1lido","auth/operation-not-allowed":"Operaci\xF3n no permitida","auth/weak-password":"La contrase\xF1a es muy d\xE9bil"}[t]||"Error al registrar usuario"}loading=this.registerResource.isLoading;errorMessage=()=>{let t=this.registerResource.error();if(!t)return"";let r=t.code||"";return{"auth/email-already-in-use":"Este correo ya est\xE1 registrado","auth/invalid-email":"El correo electr\xF3nico no es v\xE1lido","auth/operation-not-allowed":"Operaci\xF3n no permitida","auth/weak-password":"La contrase\xF1a es muy d\xE9bil"}[r]||"Error al registrar usuario"};get email(){return this.registerForm.get("email")}get password(){return this.registerForm.get("password")}get confirmPassword(){return this.registerForm.get("confirmPassword")}static \u0275fac=function(r){return new(r||i)};static \u0275cmp=E({type:i,selectors:[["app-register-page"]],decls:38,vars:13,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-gradient-to-br","from-secondary","to-accent","p-4"],[1,"card","w-full","max-w-md","bg-base-100","shadow-2xl"],[1,"card-body"],[1,"text-center","mb-6"],[1,"text-3xl","font-bold","text-secondary","mb-2"],[1,"text-base-content/70"],[1,"alert","alert-error","mb-4"],[3,"ngSubmit","formGroup"],[1,"form-control"],[1,"label"],[1,"label-text"],["type","email","formControlName","email","placeholder","ejemplo@correo.com",1,"input","input-bordered","w-full"],[1,"block","text-red-500","text-sm","mt-1"],[1,"form-control","mt-4"],["type","password","formControlName","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"input","input-bordered","w-full"],["type","password","formControlName","confirmPassword","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"input","input-bordered","w-full"],[1,"form-control","mt-6"],["type","submit",1,"btn","btn-secondary","w-full",3,"disabled"],[1,"text-center","mt-4"],[1,"text-sm","text-base-content/70"],["routerLink","/auth/login","routerLink","/auth/login",1,"link","link-secondary","font-semibold"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"stroke-current","shrink-0","h-6","w-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"loading","loading-spinner","loading-sm"]],template:function(r,e){if(r&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),s(5,"Crear Cuenta"),o(),n(6,"p",5),s(7,"Reg\xEDstrate para comenzar"),o()(),m(8,Y,5,1,"div",6),n(9,"form",7),P("ngSubmit",function(){return e.onSubmit()}),n(10,"div",8)(11,"label",9)(12,"span",10),s(13,"Correo electr\xF3nico"),o()(),u(14,"input",11),m(15,J,2,1,"span",12),o(),n(16,"div",13)(17,"label",9)(18,"span",10),s(19,"Contrase\xF1a"),o()(),u(20,"input",14),m(21,K,2,1,"span",12),o(),n(22,"div",13)(23,"label",9)(24,"span",10),s(25,"Confirmar Contrase\xF1a"),o()(),u(26,"input",15),m(27,Q,2,1,"span",12),o(),n(28,"div",16)(29,"button",17),m(30,W,2,0)(31,X,1,0),o()()(),n(32,"div",18)(33,"p",19),s(34," \xBFYa tienes cuenta? "),n(35,"a",20),s(36," Inicia sesi\xF3n aqu\xED "),o()()()(),s(37,"a "),o()()),r&2){let l,v,h;a(8),d(e.registerResource.error()?8:-1),a(),F("formGroup",e.registerForm),a(5),w("input-error",(e.email==null?null:e.email.invalid)&&(e.email==null?null:e.email.touched)),a(),d((l=e.registerForm.get("email"))!=null&&l.invalid&&((l=e.registerForm.get("email"))!=null&&l.touched)?15:-1),a(5),w("input-error",(e.password==null?null:e.password.invalid)&&(e.password==null?null:e.password.touched)),a(),d((v=e.registerForm.get("password"))!=null&&v.invalid&&((v=e.registerForm.get("password"))!=null&&v.touched)?21:-1),a(5),w("input-error",(e.confirmPassword==null?null:e.confirmPassword.invalid)&&(e.confirmPassword==null?null:e.confirmPassword.touched)),a(),d((h=e.registerForm.get("confirmPassword"))!=null&&h.invalid&&((h=e.registerForm.get("confirmPassword"))!=null&&h.touched)?27:-1),a(2),F("disabled",e.loading()||e.registerForm.invalid),a(),d(e.loading()?30:31)}},dependencies:[S,A,j,U,V,I,q,B,k,M],encapsulation:2})};export{H as RegisterPage};
